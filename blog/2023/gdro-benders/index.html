<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Exploring Group Distributionally Robust Optimization in Machine Learning - A Stochastic Optimization Perspective | Jiayu (Mila) Wang</title> <meta name="author" content="Jiayu (Mila) Wang"> <meta name="description" content="leveraging benders decomposition to solve group distributionally robust optimization"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <script src="https://kit.fontawesome.com/b6a29bc49e.js" crossorigin="anonymous"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%94%A5&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jiayuww.github.io/blog/2023/gdro-benders/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jiayu </span>(Mila) Wang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Exploring Group Distributionally Robust Optimization in Machine Learning - A Stochastic Optimization Perspective</h1> <p class="post-meta">December 16, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/optimization"> <i class="fas fa-hashtag fa-sm"></i> optimization</a>   <a href="/blog/tag/ml"> <i class="fas fa-hashtag fa-sm"></i> ML</a>     ·   <a href="/blog/category/blockquotes"> <i class="fas fa-tag fa-sm"></i> blockquotes</a>   <a href="/blog/category/course-projects"> <i class="fas fa-tag fa-sm"></i> course-projects</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <section class="hero"> <div class="hero-body"> <div class="container is-max-desktop"> <div class="columns is-centered"> <div class="column has-text-centered"> <div class="column has-text-centered"> <div class="publication-links"> <span class="link-block"> <a href="https://github.com/jiayuww/gdro-benders/blob/main/cs719_GDRO_JiayuWang.pdf" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="fas fa-file-pdf"></i> </span> <span>Paper</span> </a> </span> <span class="link-block"> <a href="https://github.com/jiayuww/gdro-benders" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="fab fa-github"></i> </span> <span>Code</span> </a> </span> <span class="link-block"> <a href="https://github.com/jiayuww/gdro-benders" class="external-link button is-normal is-rounded is-dark" rel="external nofollow noopener" target="_blank"> <span class="icon"> <i class="far fa-images"></i> </span> <span>Data</span> </a> </span> </div> </div> </div> </div> </div> </div> </section> <section class="section"> <div class="container is-max-desktop"> <div class="columns is-centered has-text-centered"> <div class="column is-four-fifths"> <div class="content has-text-justified"> <p> In this work, we explore binary classification problem under spurious correlations (prior shifts from the training to the test distribution). We discuss the formulation of four potential solutions and empirically examine the effectiveness of three methods: ERM with SGD, GDRO with Online Optimization, and GDRO with Benders Decomposition. </p> <p> Our findings reveal that both Online Optimization and Benders Decomposition excel under strong spurious correlations, with Benders Decomposition slightly outperforming Online Optimization. However, ERM still demonstrates effective performance under weak spurious correlation. In terms of computational costs, Online Optimization is significantly more demanding compared to other methods. We also observe that both ERM and Online Optimization are sensitive to learning rate adjustments. Benders Decomposition, on the other hand, is insensitive w.r.t. key parameters (\(\delta\) and \(C\)). Consequently, when convexity conditions are satisfied, Benders Decomposition offers a more stable and time-efficient solution than Online Optimization and ERM under strong spurious correlation. </p> </div> </div> </div> <section class="section" id="Main Results"> <h2 class="title">Main Results</h2> <div class="row mt-3"> <div class="col-md-6 mt-3"> <figure> <picture> <img src="/assets/img/train_200_cov2_231205-0052.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> (a) Training Set (\(\rho = 0.8\)) </div> </div> <div class="col-md-6 mt-3"> <figure> <picture> <img src="/assets/img/test_200_cov2_231205-2108_model-erm_bc_lr-0.4_mo-0.9_wd-0.0001_train-231205-0052_epoch-30.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> (b) ERM </div> </div> </div> <div class="row mt-3"> <div class="col-md-6 mt-3"> <figure> <picture> <img src="/assets/img/test_200_cov2_231205-2108_model-online_lr-0.2_mo-0.9_wd-0.0001_train-231205-0052.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> (c) OnlineOpt </div> </div> <div class="col-md-6 mt-3"> <figure> <picture> <img src="/assets/img/test_200_cov2_231205-2108_model-benders_delta-0.0001_C-50_train-231205-0052.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> (d) Benders </div> </div> </div> <div class="caption"> Visualization of decision boundaries. We consider binary classification with four groups. Figures (a) to (d) display training and test sets with respective decision boundaries for ERM, OnlineOpt, and Benders. The red line represents the decision boundary where the model predicts \(y=1\) above the line and \(y=0\) otherwise. Horizontal lines indicate desirable classifiers while vertical lines indicate reliance on spurious correlations. </div> <table style="width: 100%; border-collapse: collapse;" border="1"> <caption> Comparison of three methods in binary classification by varying degrees of spurious correlation \(\rho\) from 0.5 (no correlation) to 0.9 (strong correlation). We report average and worst-group accuracies on the same test set. The highest accuracies are marked in #fff3b0. </caption> <thead> <tr> <th rowspan="2">Method</th> <th colspan="2">\(\rho = 0.5\) (unbiased)</th> <th colspan="2">\(\rho = 0.6\)</th> <th colspan="2">\(\rho = 0.7\)</th> <th colspan="2">\(\rho = 0.8\)</th> <th colspan="2">\(\rho = 0.9\)</th> </tr> <tr> <th>avg acc</th> <th>worst acc</th> <th>avg acc</th> <th>worst acc</th> <th>avg acc</th> <th>worst acc</th> <th>avg acc</th> <th>worst acc</th> <th>avg acc</th> <th>worst acc</th> </tr> </thead> <tbody> <tr> <td>ERM</td> <td>0.895</td> <td style="background-color: #fff3b0;">0.890</td> <td>0.905</td> <td style="background-color: #fff3b0;">0.880</td> <td>0.890</td> <td>0.790</td> <td>0.865</td> <td>0.760</td> <td>0.860</td> <td>0.750</td> </tr> <tr> <td>OnlineOpt</td> <td>0.905</td> <td>0.850</td> <td>0.905</td> <td style="background-color: #fff3b0;">0.880</td> <td>0.905</td> <td>0.860</td> <td style="background-color: #fff3b0;">0.905</td> <td>0.830</td> <td>0.885</td> <td style="background-color: #fff3b0;">0.900</td> </tr> <tr> <td>Benders</td> <td style="background-color: #fff3b0;">0.910</td> <td>0.870</td> <td style="background-color: #fff3b0;">0.910</td> <td style="background-color: #fff3b0;">0.880</td> <td style="background-color: #fff3b0;">0.910</td> <td style="background-color: #fff3b0;">0.870</td> <td style="background-color: #fff3b0;">0.905</td> <td style="background-color: #fff3b0;">0.880</td> <td style="background-color: #fff3b0;">0.890</td> <td style="background-color: #fff3b0;">0.900</td> </tr> </tbody> </table> <p> <strong>OnlineOpt and Benders excel under stronger spurious correlations.</strong> Across scenarios with varying <span class="math">\(\rho\)</span>, both OnlineOpt and Benders generally outperform or match ERM in terms of average and worst-group accuracy, except in cases with minimal prior shifts from the training to the test distribution. Notably, the performance gap between ERM and the other two methods widens as <span class="math">\(\rho\)</span> increases, indicating a decrease in ERM's robustness under stronger spurious correlations. </p> <p> <strong>Benders marginally surpasses OnlineOpt across all settings.</strong> OnlineOpt and Benders demonstrate similar performance in terms of average and worst-group accuracies. However, Benders exhibits a slight advantage over OnlineOpt consistently in all the tasks evaluated. </p> <div class="row mt-3"> <div class="col-md-12 mt-3"> <figure> <picture> <img src="/assets/img/time.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Total time (seconds) of three methods under different degrees of spurious correlation \(\rho\). </div> </div> </div> <p> <strong>OnlineOpt incurs the highest time complexity.</strong> We calculate the total training time for methods under various <span class="math">\(\rho\)</span> levels. We can see that ERM is the most computationally efficient one, consistently outperforming OnlineOpt and Benders across various <span class="math">\(\rho\)</span> levels. OnlineOpt incurs the highest computational duration, which suggests its substantial complexity. Benders is more efficient than OnlineOpt but still lags behind ERM, particularly when spurious correlation intensifies. This highlights the trade-off between computational efficiency and robustness against varying degrees of spurious correlations for these methods. </p> </section> <section class="section" id="Ablation Studies"> <h2 class="title">Ablation Studies</h2> <div class="row"> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/lr_erm.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of ERM for different learning rates</div> </div> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/lr_onlineopt.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of OnlineOpt for different learning rates</div> </div> </div> <div class="caption text-center"> Accuracy comparison of ERM vs OnlineOpt for different learning rates. OnlineOpt outperforms ERM across different learning rates in general. ERM is more sensitive to learning rate than Online Optimization. </div> <p> <strong> Sensitivity of ERM and OnlineOpt to learning rate. </strong> 1) ERM is sensitive to changes in the learning rate, exhibiting notable variations in both average and worst group accuracies across different rates. 2) In contrast, OnlineOpt demonstrates considerably less sensitivity to learning rate adjustments, with the exception of a very small learning rate (0.0001). This suggests an advantage of OnlineOpt, as it does not require as meticulous a calibration of the learning rate compared to ERM. </p> <div class="row"> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/bs_erm.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of ERM for different batch sizes</div> </div> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/bs_onlineopt.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of OnlineOpt for different batch sizes</div> </div> </div> <div class="caption text-center"> Comparative analysis of ERM and OnlineOpt across various batch sizes. Both methods exhibit robustness to batch size variations. ERM demonstrates a more versatile range in batch size adaptability, in contrast to OnlineOpt constrained by the size of the smallest group. </div> <p> ERM and OnlineOpt are stable across various batch sizes. </p> <div class="row"> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/delta_benders.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of Benders for different \(\delta\)</div> </div> <div class="col-md-6 text-center"> <figure> <picture> <img src="/assets/img/c_benders.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption">Accuracies of Benders for different \(C\)</div> </div> </div> <p> Benders is robust to parameters <span class="math">\(\delta\)</span> and <span class="math">\(C\)</span>, which are the only parameters in this method. </p> </section> </div></section> </div></article> </div> </div> </body> </html><html> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/text2latex/">Unveiling the Potential of Language Models in LaTeX Synthesis</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"jiayuww/discussions","data-repo-id":"R_kgDOLE-k1g","data-category":"Comments","data-category-id":"DIC_kwDOLE-k1s4CceGf","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jiayu (Mila) Wang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: October 09, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </html>